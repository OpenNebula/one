# Initial default configuration placed by opennebula-common
# package. Latest default configurations are located in
# /usr/share/one/ssh/.

#####################################################################
# WARNING: This configuration file is ONLY for OpenSSH 7.6 and newer!
#####################################################################

Host *
  # since SSH version 7.6+
  StrictHostKeyChecking accept-new
  ServerAliveInterval 10
  ControlMaster auto
  # BEWARE!
  #
  # The following options must be in-sync with the accompanying cronjob:
  #   /etc/cron.d/opennebula-ssh-socks-cleaner
  #
  # This is a workaround for the issues and races encountered when SSH is
  # handling these master sockets.
  #
  # 'ControlPersist' cannot be set less than 120 (two minutes) to offset the
  # minimum one minute time before each cronjob check! It will also not change
  # behavior even if it set much higher or to infinity (0).
  #
  # (+) Add another 10s to give crond a room for cleanup
  ControlPersist 130s
  # 'ControlPath' must match the 'find' command in the cronjob above!
  ControlPath ~/.ssh-M-%C.sock
